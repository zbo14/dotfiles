#!/bin/bash

if [ -z "$1" ]; then
  warn "Usage: brutesubs <domain1> [domain2] ..."
  exit 1
fi

tf="$(mktemp)"

warn "[-] Generating wordlist"

for root in "$@"; do
  while read -r sub; do
    echo "$sub.$root" >> "$tf"
  done < ~/Projects/wordlists/subdomains.txt
done

warn "[-] Brute-forcing subdomains"

~/Projects/massdns/bin/massdns \
  -o S \
  -r ~/Projects/massdns/lists/resolvers.txt \
  "$tf" \
  | cut -d ' ' -f1 \
  | rev \
  | cut -c2- \
  | rev

rm "$tf"
